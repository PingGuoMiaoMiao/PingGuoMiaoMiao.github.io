---
import BaseLayout from "../layouts/BaseLayout.astro";
const posts = await Astro.glob('../pages/posts/*.md');
// 假设 frontmatter.categories 为字符串或数组；无则归入 “未分类”
const catMap: Record<string, typeof posts> = {};
for (const p of posts) {
  const cats = ([] as string[]).concat(p.frontmatter.categories || '未分类');
  for (const c of cats) {
    catMap[c] ||= [] as any;
    catMap[c].push(p);
  }
}
const pageTitle = "分类";
---
<BaseLayout pageTitle={pageTitle}>
  <section class="cats">
    {Object.keys(catMap).sort().map((c) => (
      <div class="cat-card">
        <h3>{c}</h3>
        <ul>
          {catMap[c].map((p: any) => (
            <li><a href={p.url}>{p.frontmatter.title}</a></li>
          ))}
        </ul>
      </div>
    ))}
  </section>
</BaseLayout>
<style>
  .cats { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 1rem; }
  .cat-card { background: var(--surface); border-radius: var(--radius); padding: .9rem 1rem; box-shadow: inset 0 0 0 1px var(--border); }
  ul { list-style: none; padding: 0; display: grid; gap: .35rem; margin-top: .5rem; }
  a { text-decoration: none; color: #eaf2ff; }
</style>


